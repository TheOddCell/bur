#!/bedrock/libexec/busybox sh
#
# Package Manager Manager Manager Gitfetch
#
#      This is free and unencumbered software released into the public domain.
#      Anyone is free to copy, modify, publish, use, compile, sell, or
#      distribute this software, either in source code form or as a compiled
#      binary, for any purpose, commercial or non-commercial, and by any means.
#
#      For more information, please refer to <https://unlicense.org/>
#
# Copyleft (â†„) The Odd Cell <me@oddcell.ca>
#
. /bedrock/share/common-code
trap - EXIT
trap "echo 'an unexpected error occurred';exit 1" ERR
set -e

parse_metadata() {
  while IFS='=' read -r key value; do
    [ -z "$key" ] && continue
    eval "$key=\$value"
  done < "$1"
}

ask_sure() {
  echo -n "$1"
  while :; do
    read answer
    case "${answer#?}" in
      "") ;; # ignore empty or multi-char
      *) answer=${answer%${answer#?}} ;; # only first char
    esac
    case "$answer" in
      [Yy]) echo; return 0 ;;
      [Nn]) echo; echo "Aborting."; exit 1 ;;
      *) echo -n "Please answer Y or N: " ;;
    esac
  done
}

# Check if running as root
require_root() {
  if [ "$(id -u)" != 0 ]; then
    echo "This command requires root privileges."
    exit 1
  fi
}

name="$1"
shift||true
repo="$1"
shift||true

